name: Update Ads from WordPress

on:
  schedule:
    - cron: '0 */6 * * *' # Ch·∫°y t·ª± ƒë·ªông 6 ti·∫øng m·ªôt l·∫ßn
  workflow_dispatch:      # Cho ph√©p b·∫•m n√∫t ch·∫°y tay ƒë·ªÉ test

jobs:
  sync:
    runs-on: ubuntu-latest
    permissions:
      contents: write # C·∫•p quy·ªÅn ghi file v√†o repo

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: Install Requests
        run: pip install requests

      - name: Run Sync Script
        env:
          WP_API_KEY: ${{ secrets.WP_API_KEY }} # N·∫°p Key t·ª´ Secret v√†o
        run: python sync_ads.py

      - name: Commit and Push changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ü§ñ Auto-update ads from WordPress"
          file_pattern: "ads.json"
